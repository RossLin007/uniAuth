---
  openapi: "3.0.3"
  info: 
    title: "UniAuth API"
    description: "\n# UniAuth ç»Ÿä¸€è®¤è¯æœåŠ¡ API\n\nUniAuth æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ç»Ÿä¸€è®¤è¯æœåŠ¡ï¼Œæ”¯æŒå¤šç§ç™»å½•æ–¹å¼å’Œ OAuth 2.0 æä¾›å•†åŠŸèƒ½ã€‚\n\n## ç‰¹æ€§\n\n- ğŸ“± æ‰‹æœºéªŒè¯ç ç™»å½•\n- ğŸ“§ é‚®ç®±å¯†ç ç™»å½•\n- ğŸ” OAuth 2.0 ç¤¾äº¤ç™»å½• (Google, GitHub, WeChat)\n- ğŸ”‘ Passkey / WebAuthn æ— å¯†ç ç™»å½•\n- ğŸ¢ å¯ä¿¡å®¢æˆ·ç«¯ API (Trusted Client)\n- ğŸ”— è´¦å·å…³è” (Account Linking)\n- ğŸ« JWT Token ç®¡ç†\n- ğŸ”„ Token è‡ªåŠ¨åˆ·æ–°\n- ğŸ“Š å¤šè®¾å¤‡ä¼šè¯ç®¡ç†\n- ğŸ¢ OAuth 2.0 Provider èƒ½åŠ›\n- ğŸ“‹ OIDC Discovery\n\n## è®¤è¯æ–¹å¼\n\nå¤§å¤šæ•° API éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ Bearer Tokenï¼š\n\n```\nAuthorization: Bearer <access_token>\n```\n\nå¯ä¿¡å®¢æˆ·ç«¯ API éœ€è¦ X-Client-Id + X-Client-Secret è¯·æ±‚å¤´ã€‚\n\n## é”™è¯¯å¤„ç†\n\næ‰€æœ‰ API è¿”å›ç»Ÿä¸€çš„é”™è¯¯æ ¼å¼ï¼š\n\n```json\n{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"ERROR_CODE\",\n    \"message\": \"Human-readable error message\"\n  }\n}\n```\n        "
    version: "1.0.0"
    contact: 
      name: "UniAuth Support"
      url: "https://github.com/your-org/uniauth"
    license: 
      name: "MIT"
      url: "https://opensource.org/licenses/MIT"
  servers: 
    - 
      url: "http://localhost:3000"
      description: "Development Server"
    - 
      url: "https://auth.example.com"
      description: "Production Server"
  tags: 
    - 
      name: "Health"
      description: "å¥åº·æ£€æŸ¥ / Health Check"
    - 
      name: "Authentication"
      description: "è®¤è¯ç›¸å…³ / Authentication"
    - 
      name: "User"
      description: "ç”¨æˆ·ç®¡ç† / User Management"
    - 
      name: "OAuth2"
      description: "OAuth 2.0 æä¾›å•† / OAuth 2.0 Provider"
    - 
      name: "Passkey"
      description: "Passkey / WebAuthn æ— å¯†ç è®¤è¯ / Passwordless Authentication"
    - 
      name: "TrustedAuth"
      description: "å¯ä¿¡å®¢æˆ·ç«¯ API / Trusted Client API"
    - 
      name: "AccountLinking"
      description: "è´¦å·å…³è” / Account Linking"
    - 
      name: "Branding"
      description: "å“ç‰Œé…ç½® / Branding Configuration"
    - 
      name: "MFA"
      description: "å¤šå› ç´ è®¤è¯ / Multi-Factor Authentication"
    - 
      name: "OIDC"
      description: "OpenID Connect Discovery"
  paths: 
    /health: 
      get: 
        operationId: getHealth
        tags: 
          - "Health"
        summary: "ç®€å•å¥åº·æ£€æŸ¥ / Simple Health Check"
        description: "è¿”å›æœåŠ¡è¿è¡ŒçŠ¶æ€ï¼Œç”¨äºè´Ÿè½½å‡è¡¡å™¨"
        responses: 
          "200": 
            description: "æœåŠ¡æ­£å¸¸"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    status: 
                      type: "string"
                      example: "ok"
                    timestamp: 
                      type: "string"
                      format: "date-time"
    /health/ready: 
      get: 
        operationId: getHealthReady
        tags: 
          - "Health"
        summary: "å°±ç»ªæ£€æŸ¥ / Readiness Check"
        description: "æ·±åº¦å¥åº·æ£€æŸ¥ï¼ŒéªŒè¯æ•°æ®åº“å’Œ Redis è¿æ¥"
        responses: 
          "200": 
            description: "æ‰€æœ‰ä¾èµ–æ­£å¸¸"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    status: 
                      type: "string"
                      enum: 
                        - "healthy"
                        - "degraded"
                    checks: 
                      type: "object"
                      properties: 
                        database: 
                          type: "object"
                        redis: 
                          type: "object"
                        memory: 
                          type: "object"
                    version: 
                      type: "string"
                    uptime: 
                      type: "number"
          "503": 
            description: "æœåŠ¡é™çº§"
    /api/v1/auth/phone/send-code: 
      post: 
        operationId: sendPhoneCode
        tags: 
          - "Authentication"
        summary: "å‘é€æ‰‹æœºéªŒè¯ç  / Send Phone Verification Code"
        description: "å‘æ‰‹æœºå‘é€éªŒè¯ç "
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  phone: 
                    type: "string"
                    example: "+8613800138000"
                required: 
                  - "phone"
        responses: 
          "200": 
            description: "éªŒè¯ç å‘é€æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                      example: true
                    data: 
                      type: "object"
                      properties: 
                        expires_in: 
                          type: "number"
                          example: 300
                        retry_after: 
                          type: "number"
                          example: 60
          "429": 
            description: "è¯·æ±‚è¿‡äºé¢‘ç¹"
    /api/v1/auth/phone/verify: 
      post: 
        operationId: verifyPhoneCode
        tags: 
          - "Authentication"
        summary: "æ‰‹æœºéªŒè¯ç ç™»å½• / Phone Code Login"
        description: "ä½¿ç”¨æ‰‹æœºéªŒè¯ç ç™»å½•æˆ–æ³¨å†Œ"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  phone: 
                    type: "string"
                    example: "+8613800138000"
                  code: 
                    type: "string"
                    example: "123456"
                required: 
                  - "phone"
                  - "code"
        responses: 
          "200": 
            description: "ç™»å½•æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LoginResponse"
          "401": 
            description: "éªŒè¯ç é”™è¯¯æˆ–å·²è¿‡æœŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/Error"
    /api/v1/auth/email/send-code: 
      post: 
        operationId: sendEmailCode
        tags: 
          - "Authentication"
        summary: "å‘é€é‚®ç®±éªŒè¯ç  / Send Email Verification Code"
        description: "å‘é‚®ç®±å‘é€éªŒè¯ç "
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  type: 
                    type: "string"
                    enum: 
                      - "login"
                      - "register"
                      - "reset"
                      - "email_verify"
                    default: "login"
                required: 
                  - "email"
        responses: 
          "200": 
            description: "éªŒè¯ç å‘é€æˆåŠŸ"
          "429": 
            description: "è¯·æ±‚è¿‡äºé¢‘ç¹"
    /api/v1/auth/email/verify: 
      post: 
        operationId: verifyEmailCode
        tags: 
          - "Authentication"
        summary: "é‚®ç®±éªŒè¯ç ç™»å½• / Email Code Login"
        description: "ä½¿ç”¨é‚®ç®±éªŒè¯ç ç™»å½•"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  code: 
                    type: "string"
                    example: "123456"
                required: 
                  - "email"
                  - "code"
        responses: 
          "200": 
            description: "ç™»å½•æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LoginResponse"
          "401": 
            description: "éªŒè¯ç é”™è¯¯æˆ–å·²è¿‡æœŸ"
    /api/v1/auth/email/login: 
      post: 
        operationId: loginWithEmail
        tags: 
          - "Authentication"
        summary: "é‚®ç®±å¯†ç ç™»å½• / Email Password Login"
        description: "ä½¿ç”¨é‚®ç®±å’Œå¯†ç ç™»å½•ï¼Œè¿”å›è®¿é—®ä»¤ç‰Œ"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  password: 
                    type: "string"
                    minLength: 8
                required: 
                  - "email"
                  - "password"
        responses: 
          "200": 
            description: "ç™»å½•æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LoginResponse"
          "401": 
            description: "é‚®ç®±æˆ–å¯†ç é”™è¯¯"
    /api/v1/auth/refresh: 
      post: 
        operationId: refreshToken
        tags: 
          - "Authentication"
        summary: "åˆ·æ–°ä»¤ç‰Œ / Refresh Token"
        description: "ä½¿ç”¨ refresh token åˆ·æ–°è®¿é—®ä»¤ç‰Œ"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  refresh_token: 
                    type: "string"
                required: 
                  - "refresh_token"
        responses: 
          "200": 
            description: "åˆ·æ–°æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
                        expires_in: 
                          type: "number"
    /api/v1/auth/logout: 
      post: 
        operationId: logout
        tags: 
          - "Authentication"
        summary: "ç™»å‡º / Logout"
        description: "æ³¨é”€å½“å‰ä¼šè¯å¹¶ä½¿ token å¤±æ•ˆ"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  refresh_token: 
                    type: "string"
        responses: 
          "200": 
            description: "ç™»å‡ºæˆåŠŸ"
    /api/v1/auth/logout-all: 
      post: 
        operationId: logoutAll
        tags: 
          - "Authentication"
        summary: "å…¨è®¾å¤‡ç™»å‡º / Logout All Devices"
        description: "æ³¨é”€ç”¨æˆ·æ‰€æœ‰ä¼šè¯ï¼Œä½¿æ‰€æœ‰ token å¤±æ•ˆ"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "å…¨éƒ¨è®¾å¤‡ç™»å‡ºæˆåŠŸ"
    /api/v1/auth/email/register: 
      post: 
        operationId: registerWithEmail
        tags: 
          - "Authentication"
        summary: "é‚®ç®±æ³¨å†Œ / Email Registration"
        description: "ä½¿ç”¨é‚®ç®±å’Œå¯†ç æ³¨å†Œæ–°ç”¨æˆ·"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  password: 
                    type: "string"
                    minLength: 8
                  code: 
                    type: "string"
                    description: "é‚®ç®±éªŒè¯ç "
                required: 
                  - "email"
                  - "password"
        responses: 
          "200": 
            description: "æ³¨å†ŒæˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/LoginResponse"
          "400": 
            description: "é‚®ç®±å·²å­˜åœ¨æˆ–éªŒè¯ç é”™è¯¯"
    /api/v1/auth/verify: 
      post: 
        operationId: verifyToken
        tags: 
          - "Authentication"
        summary: "éªŒè¯ Token / Verify Token"
        description: "éªŒè¯è®¿é—®ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  token: 
                    type: "string"
                required: 
                  - "token"
        responses: 
          "200": 
            description: "Token æœ‰æ•ˆ"
          "401": 
            description: "Token æ— æ•ˆæˆ–å·²è¿‡æœŸ"
    /api/v1/auth/google: 
      get: 
        operationId: oauthGoogle
        tags: 
          - "Authentication"
        summary: "Google OAuth ç™»å½• / Google OAuth Login"
        description: "é‡å®šå‘åˆ° Google ç™»å½•é¡µé¢"
        responses: 
          "302": 
            description: "é‡å®šå‘åˆ° Google"
    /api/v1/auth/github: 
      get: 
        operationId: oauthGithub
        tags: 
          - "Authentication"
        summary: "GitHub OAuth ç™»å½• / GitHub OAuth Login"
        description: "é‡å®šå‘åˆ° GitHub ç™»å½•é¡µé¢"
        responses: 
          "302": 
            description: "é‡å®šå‘åˆ° GitHub"
    /api/v1/auth/wechat: 
      get: 
        operationId: oauthWechat
        tags: 
          - "Authentication"
        summary: "å¾®ä¿¡ OAuth ç™»å½• / WeChat OAuth Login"
        description: "é‡å®šå‘åˆ°å¾®ä¿¡ç™»å½•é¡µé¢"
        responses: 
          "302": 
            description: "é‡å®šå‘åˆ°å¾®ä¿¡"
    /api/v1/user/me: 
      get: 
        operationId: getCurrentUser
        tags: 
          - "User"
        summary: "è·å–å½“å‰ç”¨æˆ· / Get Current User"
        description: "è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/UserResponse"
          "401": 
            description: "æœªè®¤è¯"
      patch: 
        operationId: updateCurrentUser
        tags: 
          - "User"
        summary: "æ›´æ–°ç”¨æˆ·èµ„æ–™ / Update Profile"
        description: "æ›´æ–°å½“å‰ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  nickname: 
                    type: "string"
                  avatar_url: 
                    type: "string"
                    format: "uri"
        responses: 
          "200": 
            description: "æ›´æ–°æˆåŠŸ"
    /api/v1/user/sessions: 
      get: 
        operationId: getUserSessions
        tags: 
          - "User"
        summary: "è·å–ç™»å½•è®¾å¤‡ / Get Sessions"
        description: "è·å–ç”¨æˆ·çš„æ‰€æœ‰æ´»è·ƒä¼šè¯åˆ—è¡¨"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
    /api/v1/user/sessions/{id}: 
      delete: 
        operationId: deleteUserSession
        tags: 
          - "User"
        summary: "æ’¤é”€ç‰¹å®šä¼šè¯ / Revoke Session"
        description: "åˆ é™¤ç”¨æˆ·çš„æŒ‡å®šä¼šè¯"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "id"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          "200": 
            description: "æ’¤é”€æˆåŠŸ"
          "404": 
            description: "ä¼šè¯ä¸å­˜åœ¨"
    /api/v1/user/bindings: 
      get: 
        operationId: getUserBindings
        tags: 
          - "User"
        summary: "è·å–è´¦æˆ·ç»‘å®š / Get Account Bindings"
        description: "è·å–ç”¨æˆ·å·²ç»‘å®šçš„ç¬¬ä¸‰æ–¹è´¦å·åˆ—è¡¨"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "array"
                      items: 
                        type: "object"
                        properties: 
                          provider: 
                            type: "string"
                          provider_user_id: 
                            type: "string"
                          created_at: 
                            type: "string"
                            format: "date-time"
    /api/v1/user/unbind/{provider}: 
      delete: 
        operationId: unbindProvider
        tags: 
          - "User"
        summary: "è§£ç»‘ OAuth è´¦æˆ· / Unbind OAuth"
        description: "è§£ç»‘æŒ‡å®šçš„ç¬¬ä¸‰æ–¹ç™»å½•æ–¹å¼"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "provider"
            in: "path"
            required: true
            schema: 
              type: "string"
              enum: 
                - "google"
                - "github"
                - "wechat"
        responses: 
          "200": 
            description: "è§£ç»‘æˆåŠŸ"
          "400": 
            description: "æ— æ³•è§£ç»‘ï¼ˆå”¯ä¸€ç™»å½•æ–¹å¼ï¼‰"
    /api/v1/user/bind/phone: 
      post: 
        operationId: bindPhone
        tags: 
          - "User"
        summary: "ç»‘å®šæ‰‹æœºå· / Bind Phone"
        description: "ç»‘å®šæ‰‹æœºå·åˆ°å½“å‰ç”¨æˆ·"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  phone: 
                    type: "string"
                  code: 
                    type: "string"
                required: 
                  - "phone"
                  - "code"
        responses: 
          "200": 
            description: "ç»‘å®šæˆåŠŸ"
          "400": 
            description: "éªŒè¯ç é”™è¯¯æˆ–æ‰‹æœºå·å·²è¢«ä½¿ç”¨"
    /api/v1/user/bind/email: 
      post: 
        operationId: bindEmail
        tags: 
          - "User"
        summary: "ç»‘å®šé‚®ç®± / Bind Email"
        description: "ç»‘å®šé‚®ç®±åˆ°å½“å‰ç”¨æˆ·"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  code: 
                    type: "string"
                required: 
                  - "email"
                  - "code"
        responses: 
          "200": 
            description: "ç»‘å®šæˆåŠŸ"
          "400": 
            description: "éªŒè¯ç é”™è¯¯æˆ–é‚®ç®±å·²è¢«ä½¿ç”¨"
    /api/v1/user/authorized-apps: 
      get: 
        operationId: listAuthorizedApps
        tags: 
          - "User"
        summary: "è·å–å·²æˆæƒåº”ç”¨ / Get Authorized Apps"
        description: "è·å–ç”¨æˆ·æˆæƒçš„ç¬¬ä¸‰æ–¹åº”ç”¨åˆ—è¡¨"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
    /api/v1/user/authorized-apps/{clientId}: 
      delete: 
        operationId: revokeAuthorizedApp
        tags: 
          - "User"
        summary: "æ’¤é”€åº”ç”¨æˆæƒ / Revoke App Authorization"
        description: "æ’¤é”€æŒ‡å®šåº”ç”¨çš„æˆæƒ"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "clientId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          "200": 
            description: "æ’¤é”€æˆåŠŸ"
    /api/v1/mfa/status: 
      get: 
        operationId: getMfaStatus
        tags: 
          - "MFA"
        summary: "è·å– MFA çŠ¶æ€ / Get MFA Status"
        description: "è·å–ç”¨æˆ· MFA è®¾ç½®çŠ¶æ€"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        enabled: 
                          type: "boolean"
                        methods: 
                          type: "array"
                          items: 
                            type: "string"
    /api/v1/mfa/setup: 
      post: 
        operationId: mfaSetup
        tags: 
          - "MFA"
        summary: "å¼€å§‹ MFA è®¾ç½® / Start MFA Setup"
        description: "åˆå§‹åŒ– MFA è®¾ç½®ï¼Œç”Ÿæˆ TOTP å¯†é’¥"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        secret: 
                          type: "string"
                        qrCode: 
                          type: "string"
                          description: "Base64 QR code image"
    /api/v1/mfa/verify-setup: 
      post: 
        operationId: mfaVerifySetup
        tags: 
          - "MFA"
        summary: "éªŒè¯ MFA è®¾ç½® / Verify MFA Setup"
        description: "éªŒè¯ TOTP ä»£ç å®Œæˆ MFA è®¾ç½®"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  code: 
                    type: "string"
                    minLength: 6
                    maxLength: 6
                required: 
                  - "code"
        responses: 
          "200": 
            description: "MFA å¯ç”¨æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        recoveryCodes: 
                          type: "array"
                          items: 
                            type: "string"
    /api/v1/mfa/verify: 
      post: 
        operationId: mfaVerify
        tags: 
          - "MFA"
        summary: "éªŒè¯ MFA ä»£ç  / Verify MFA Code"
        description: "åœ¨ç™»å½•æµç¨‹ä¸­éªŒè¯ MFA ä»£ç "
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  code: 
                    type: "string"
                required: 
                  - "code"
        responses: 
          "200": 
            description: "MFA éªŒè¯æˆåŠŸ"
          "400": 
            description: "éªŒè¯ç é”™è¯¯"
    /api/v1/mfa/disable: 
      post: 
        operationId: mfaDisable
        tags: 
          - "MFA"
        summary: "ç¦ç”¨ MFA / Disable MFA"
        description: "å…³é—­ç”¨æˆ·çš„ MFA äºŒæ¬¡éªŒè¯"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  code: 
                    type: "string"
                required: 
                  - "code"
        responses: 
          "200": 
            description: "MFA å·²ç¦ç”¨"
    /api/v1/mfa/regenerate-recovery: 
      post: 
        operationId: mfaRegenerateRecovery
        tags: 
          - "MFA"
        summary: "é‡æ–°ç”Ÿæˆæ¢å¤ç  / Regenerate Recovery Codes"
        description: "é‡æ–°ç”Ÿæˆ MFA æ¢å¤ç "
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  code: 
                    type: "string"
                required: 
                  - "code"
        responses: 
          "200": 
            description: "æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        recoveryCodes: 
                          type: "array"
                          items: 
                            type: "string"
    /api/v1/oauth2/validate: 
      get: 
        operationId: oauth2Validate
        tags: 
          - "OAuth2"
        summary: "éªŒè¯å®¢æˆ·ç«¯ / Validate Client"
        description: "éªŒè¯ OAuth2 å®¢æˆ·ç«¯ä¿¡æ¯å’Œå›è°ƒåœ°å€"
        parameters: 
          - 
            name: "client_id"
            in: "query"
            required: true
            schema: 
              type: "string"
          - 
            name: "redirect_uri"
            in: "query"
            required: true
            schema: 
              type: "string"
              format: "uri"
          - 
            name: "response_type"
            in: "query"
            required: true
            schema: 
              type: "string"
              enum: 
                - "code"
          - 
            name: "scope"
            in: "query"
            schema: 
              type: "string"
          - 
            name: "state"
            in: "query"
            schema: 
              type: "string"
          - 
            name: "code_challenge"
            in: "query"
            schema: 
              type: "string"
              description: "PKCE code challenge"
          - 
            name: "code_challenge_method"
            in: "query"
            schema: 
              type: "string"
              enum: 
                - "S256"
                - "plain"
        responses: 
          "200": 
            description: "å®¢æˆ·ç«¯éªŒè¯æˆåŠŸ"
          "400": 
            description: "æ— æ•ˆçš„å®¢æˆ·ç«¯æˆ–å›è°ƒåœ°å€"
    /api/v1/oauth2/authorize: 
      post: 
        operationId: oauth2AuthorizePost
        tags: 
          - "OAuth2"
        summary: "æˆæƒè¯·æ±‚ / Authorization Request"
        description: "ç”¨æˆ·åŒæ„æˆæƒåè°ƒç”¨ï¼Œç”Ÿæˆæˆæƒç "
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  client_id: 
                    type: "string"
                  redirect_uri: 
                    type: "string"
                    format: "uri"
                  response_type: 
                    type: "string"
                    enum: 
                      - "code"
                  scope: 
                    type: "string"
                  state: 
                    type: "string"
                  code_challenge: 
                    type: "string"
                  code_challenge_method: 
                    type: "string"
                    enum: 
                      - "S256"
                      - "plain"
                required: 
                  - "client_id"
                  - "redirect_uri"
                  - "response_type"
        responses: 
          "200": 
            description: "æˆæƒæˆåŠŸï¼Œè¿”å›é‡å®šå‘ URL"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        redirect_url: 
                          type: "string"
                          format: "uri"
    /api/v1/oauth2/token: 
      post: 
        operationId: oauth2Token
        tags: 
          - "OAuth2"
        summary: "ä»¤ç‰Œäº¤æ¢ / Token Exchange"
        description: "ä½¿ç”¨æˆæƒç æˆ–å®¢æˆ·ç«¯å‡­è¯æ¢å–è®¿é—®ä»¤ç‰Œã€‚æ”¯æŒ authorization_codeï¼ˆç”¨æˆ·æˆæƒï¼‰å’Œ client_credentialsï¼ˆM2M æœºå™¨å¯¹æœºå™¨ï¼‰ä¸¤ç§æˆæƒç±»å‹ã€‚"
        requestBody: 
          required: true
          content: 
            application/x-www-form-urlencoded: 
              schema: 
                type: "object"
                properties: 
                  grant_type: 
                    type: "string"
                    enum: 
                      - "authorization_code"
                      - "client_credentials"
                    description: "æˆæƒç±»å‹ï¼šauthorization_codeï¼ˆç”¨æˆ·æˆæƒï¼‰æˆ– client_credentialsï¼ˆM2Mï¼‰"
                  client_id: 
                    type: "string"
                  client_secret: 
                    type: "string"
                  code: 
                    type: "string"
                    description: "æˆæƒç ï¼ˆgrant_type=authorization_code æ—¶å¿…å¡«ï¼‰"
                  redirect_uri: 
                    type: "string"
                    format: "uri"
                    description: "å›è°ƒåœ°å€ï¼ˆgrant_type=authorization_code æ—¶å¿…å¡«ï¼‰"
                  code_verifier: 
                    type: "string"
                    description: "PKCE code verifierï¼ˆå¯é€‰ï¼‰"
                  scope: 
                    type: "string"
                    description: "è¯·æ±‚çš„æƒé™èŒƒå›´ï¼ˆgrant_type=client_credentials æ—¶å¯é€‰ï¼‰"
                required: 
                  - "grant_type"
                  - "client_id"
            application/json: 
              schema: 
                type: "object"
                properties: 
                  grant_type: 
                    type: "string"
                    enum: 
                      - "authorization_code"
                      - "client_credentials"
                  client_id: 
                    type: "string"
                  client_secret: 
                    type: "string"
                  code: 
                    type: "string"
                  redirect_uri: 
                    type: "string"
                    format: "uri"
                  code_verifier: 
                    type: "string"
                  scope: 
                    type: "string"
                required: 
                  - "grant_type"
                  - "client_id"
        responses: 
          "200": 
            description: "ä»¤ç‰Œäº¤æ¢æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  $ref: "#/components/schemas/OAuth2TokenResponse"
          "400": 
            description: "è¯·æ±‚æ— æ•ˆ"
          "401": 
            description: "å®¢æˆ·ç«¯è®¤è¯å¤±è´¥"
    /api/v1/oauth2/userinfo: 
      get: 
        operationId: oauth2Userinfo
        tags: 
          - "OAuth2"
        summary: "ç”¨æˆ·ä¿¡æ¯ / User Info"
        description: "OIDC å…¼å®¹çš„ç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    sub: 
                      type: "string"
                      description: "User ID"
                    name: 
                      type: "string"
                    email: 
                      type: "string"
                    email_verified: 
                      type: "boolean"
                    phone_number: 
                      type: "string"
                    phone_number_verified: 
                      type: "boolean"
                    picture: 
                      type: "string"
                      format: "uri"
    # ============================================
    # MFA Login Verification / MFA ç™»å½•éªŒè¯
    # ============================================
    /api/v1/auth/mfa/verify-login: 
      post: 
        operationId: verifyMfaLogin
        tags: 
          - "Authentication"
        summary: "MFA ç™»å½•éªŒè¯ / MFA Login Verification"
        description: "ç™»å½•æ—¶éªŒè¯ MFA éªŒè¯ç ï¼ˆTOTP æˆ–æ¢å¤ç ï¼‰"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  mfa_token: 
                    type: "string"
                    description: "MFA ä»¤ç‰Œï¼ˆç™»å½•æ—¶è¿”å›ï¼‰"
                  code: 
                    type: "string"
                    description: "TOTP éªŒè¯ç ï¼ˆ6ä½ï¼‰æˆ–æ¢å¤ç "
                    minLength: 6
                    maxLength: 10
                required: 
                  - "mfa_token"
                  - "code"
        responses: 
          "200": 
            description: "MFA éªŒè¯æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                      example: true
                    data: 
                      type: "object"
                      properties: 
                        user: 
                          $ref: "#/components/schemas/User"
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
                        expires_in: 
                          type: "number"
          "401": 
            description: "MFA éªŒè¯å¤±è´¥"

    # ============================================
    # Passkey / WebAuthn
    # ============================================
    /api/v1/auth/passkey/register/options: 
      post: 
        operationId: passkeyRegisterOptions
        tags: 
          - "Passkey"
        summary: "è·å–æ³¨å†Œé€‰é¡¹ / Get Registration Options"
        description: "ç”Ÿæˆ WebAuthn æ³¨å†Œé€‰é¡¹ã€‚éœ€è¦ç”¨æˆ·å·²ç™»å½•ã€‚"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "æ³¨å†Œé€‰é¡¹"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        options: 
                          type: "object"
                          description: "PublicKeyCredentialCreationOptions"
          "401": 
            description: "æœªè®¤è¯"

    /api/v1/auth/passkey/register/verify: 
      post: 
        operationId: passkeyRegisterVerify
        tags: 
          - "Passkey"
        summary: "éªŒè¯æ³¨å†Œ / Verify Registration"
        description: "éªŒè¯ WebAuthn æ³¨å†Œå“åº”å¹¶ä¿å­˜å‡­è¯ã€‚éœ€è¦ç”¨æˆ·å·²ç™»å½•ã€‚"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  credential: 
                    type: "object"
                    description: "AuthenticatorAttestationResponse from navigator.credentials.create()"
                  name: 
                    type: "string"
                    description: "å‡­è¯åç§°ï¼ˆå¦‚ 'MacBook Pro'ï¼‰"
                required: 
                  - "credential"
        responses: 
          "200": 
            description: "æ³¨å†ŒæˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        credential_id: 
                          type: "string"
          "400": 
            description: "éªŒè¯å¤±è´¥"

    /api/v1/auth/passkey/login/options: 
      post: 
        operationId: passkeyLoginOptions
        tags: 
          - "Passkey"
        summary: "è·å–è®¤è¯é€‰é¡¹ / Get Authentication Options"
        description: "ç”Ÿæˆ WebAuthn è®¤è¯é€‰é¡¹ã€‚æ— éœ€ç™»å½•ã€‚"
        requestBody: 
          required: false
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    description: "å¯é€‰çš„ç”¨æˆ·é‚®ç®±ï¼Œç”¨äºé™å®šå‡­è¯"
        responses: 
          "200": 
            description: "è®¤è¯é€‰é¡¹"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        options: 
                          type: "object"
                          description: "PublicKeyCredentialRequestOptions"

    /api/v1/auth/passkey/login/verify: 
      post: 
        operationId: passkeyLoginVerify
        tags: 
          - "Passkey"
        summary: "éªŒè¯è®¤è¯ / Verify Authentication"
        description: "éªŒè¯ WebAuthn è®¤è¯å“åº”å¹¶ç™»å½•ã€‚æ— éœ€ç™»å½•ã€‚"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  credential: 
                    type: "object"
                    description: "AuthenticatorAssertionResponse from navigator.credentials.get()"
                required: 
                  - "credential"
        responses: 
          "200": 
            description: "è®¤è¯æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        user: 
                          $ref: "#/components/schemas/User"
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
          "401": 
            description: "è®¤è¯å¤±è´¥"

    /api/v1/auth/passkey/credentials: 
      get: 
        operationId: listPasskeyCredentials
        tags: 
          - "Passkey"
        summary: "è·å–å‡­è¯åˆ—è¡¨ / List Credentials"
        description: "è·å–å½“å‰ç”¨æˆ·çš„æ‰€æœ‰ Passkey å‡­è¯"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "å‡­è¯åˆ—è¡¨"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        credentials: 
                          type: "array"
                          items: 
                            type: "object"
                            properties: 
                              id: 
                                type: "string"
                              name: 
                                type: "string"
                              created_at: 
                                type: "string"
                                format: "date-time"
                              last_used_at: 
                                type: "string"
                                format: "date-time"
                                nullable: true

    /api/v1/auth/passkey/credentials/{credentialId}: 
      patch: 
        operationId: updatePasskeyCredential
        tags: 
          - "Passkey"
        summary: "æ›´æ–°å‡­è¯ / Update Credential"
        description: "é‡å‘½å Passkey å‡­è¯"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "credentialId"
            in: "path"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  name: 
                    type: "string"
                required: 
                  - "name"
        responses: 
          "200": 
            description: "æ›´æ–°æˆåŠŸ"
          "404": 
            description: "å‡­è¯ä¸å­˜åœ¨"
      delete: 
        operationId: deletePasskeyCredential
        tags: 
          - "Passkey"
        summary: "åˆ é™¤å‡­è¯ / Delete Credential"
        description: "åˆ é™¤ Passkey å‡­è¯"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "credentialId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          "200": 
            description: "åˆ é™¤æˆåŠŸ"
          "404": 
            description: "å‡­è¯ä¸å­˜åœ¨"

    # ============================================
    # Trusted Client API / å¯ä¿¡å®¢æˆ·ç«¯ API
    # ============================================
    /api/v1/auth/trusted/phone/send-code: 
      post: 
        operationId: trustedSendPhoneCode
        tags: 
          - "TrustedAuth"
        summary: "å‘é€æ‰‹æœºéªŒè¯ç  / Send Phone Code"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯å‘é€æ‰‹æœºéªŒè¯ç ã€‚éœ€è¦ X-Client-Id å’Œ X-Client-Secret è¯·æ±‚å¤´ã€‚"
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  phone: 
                    type: "string"
                    description: "æ‰‹æœºå·ç "
                required: 
                  - "phone"
        responses: 
          "200": 
            description: "éªŒè¯ç å·²å‘é€"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        expires_in: 
                          type: "number"
                          description: "éªŒè¯ç æœ‰æ•ˆæ—¶é—´ï¼ˆç§’ï¼‰"
          "429": 
            description: "è¯·æ±‚è¿‡äºé¢‘ç¹"

    /api/v1/auth/trusted/phone/verify: 
      post: 
        operationId: trustedVerifyPhoneCode
        tags: 
          - "TrustedAuth"
        summary: "éªŒè¯æ‰‹æœºç™»å½• / Verify Phone Login"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯éªŒè¯æ‰‹æœºéªŒè¯ç å¹¶ç™»å½•"
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  phone: 
                    type: "string"
                  code: 
                    type: "string"
                    description: "6ä½éªŒè¯ç "
                required: 
                  - "phone"
                  - "code"
        responses: 
          "200": 
            description: "ç™»å½•æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        user: 
                          $ref: "#/components/schemas/User"
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
                        mfa_required: 
                          type: "boolean"
                        mfa_token: 
                          type: "string"

    /api/v1/auth/trusted/email/send-code: 
      post: 
        operationId: trustedSendEmailCode
        tags: 
          - "TrustedAuth"
        summary: "å‘é€é‚®ç®±éªŒè¯ç  / Send Email Code"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯å‘é€é‚®ç®±éªŒè¯ç "
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                required: 
                  - "email"
        responses: 
          "200": 
            description: "éªŒè¯ç å·²å‘é€"
          "429": 
            description: "è¯·æ±‚è¿‡äºé¢‘ç¹"

    /api/v1/auth/trusted/email/verify: 
      post: 
        operationId: trustedVerifyEmailCode
        tags: 
          - "TrustedAuth"
        summary: "éªŒè¯é‚®ç®±ç™»å½• / Verify Email Login"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯éªŒè¯é‚®ç®±éªŒè¯ç å¹¶ç™»å½•"
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  code: 
                    type: "string"
                required: 
                  - "email"
                  - "code"
        responses: 
          "200": 
            description: "ç™»å½•æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        user: 
                          $ref: "#/components/schemas/User"
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"

    /api/v1/auth/trusted/email/login: 
      post: 
        operationId: trustedEmailLogin
        tags: 
          - "TrustedAuth"
        summary: "é‚®ç®±å¯†ç ç™»å½• / Email Password Login"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯ä½¿ç”¨é‚®ç®±å¯†ç ç›´æ¥ç™»å½•"
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  email: 
                    type: "string"
                    format: "email"
                  password: 
                    type: "string"
                required: 
                  - "email"
                  - "password"
        responses: 
          "200": 
            description: "ç™»å½•æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        user: 
                          $ref: "#/components/schemas/User"
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
                        mfa_required: 
                          type: "boolean"
                        mfa_token: 
                          type: "string"
          "401": 
            description: "ç™»å½•å¤±è´¥"

    /api/v1/auth/trusted/mfa/verify: 
      post: 
        operationId: trustedMfaVerify
        tags: 
          - "TrustedAuth"
        summary: "å¯ä¿¡å®¢æˆ·ç«¯ MFA éªŒè¯ / Trusted MFA Verify"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯å®Œæˆ MFA éªŒè¯"
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  mfa_token: 
                    type: "string"
                  code: 
                    type: "string"
                required: 
                  - "mfa_token"
                  - "code"
        responses: 
          "200": 
            description: "MFA éªŒè¯æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        user: 
                          $ref: "#/components/schemas/User"
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
          "401": 
            description: "éªŒè¯å¤±è´¥"

    /api/v1/auth/trusted/token/refresh: 
      post: 
        operationId: trustedTokenRefresh
        tags: 
          - "TrustedAuth"
        summary: "åˆ·æ–°ä»¤ç‰Œ / Refresh Token"
        description: "é€šè¿‡å¯ä¿¡å®¢æˆ·ç«¯åˆ·æ–°è®¿é—®ä»¤ç‰Œ"
        parameters: 
          - 
            name: "X-Client-Id"
            in: "header"
            required: true
            schema: 
              type: "string"
          - 
            name: "X-Client-Secret"
            in: "header"
            required: true
            schema: 
              type: "string"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  refresh_token: 
                    type: "string"
                required: 
                  - "refresh_token"
        responses: 
          "200": 
            description: "åˆ·æ–°æˆåŠŸ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        access_token: 
                          type: "string"
                        refresh_token: 
                          type: "string"
                        expires_in: 
                          type: "number"
          "401": 
            description: "åˆ·æ–°å¤±è´¥"

    # ============================================
    # Account Linking / è´¦å·å…³è”
    # ============================================
    /api/v1/account/linked-accounts: 
      get: 
        operationId: listLinkedAccounts
        tags: 
          - "AccountLinking"
        summary: "è·å–å…³è”è´¦å· / Get Linked Accounts"
        description: "è·å–å½“å‰ç”¨æˆ·çš„æ‰€æœ‰å·²å…³è”ç¤¾äº¤è´¦å·"
        security: 
          - 
            bearerAuth: []
        responses: 
          "200": 
            description: "å…³è”è´¦å·åˆ—è¡¨"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        accounts: 
                          type: "array"
                          items: 
                            type: "object"
                            properties: 
                              provider: 
                                type: "string"
                                enum: ["google", "github", "wechat"]
                              provider_user_id: 
                                type: "string"
                              display_name: 
                                type: "string"
                              linked_at: 
                                type: "string"
                                format: "date-time"

    /api/v1/account/link: 
      post: 
        operationId: linkAccount
        tags: 
          - "AccountLinking"
        summary: "å…³è”ç¤¾äº¤è´¦å· / Link Social Account"
        description: "é€šè¿‡ OAuth å›è°ƒæ•°æ®å…³è”æ–°çš„ç¤¾äº¤è´¦å·åˆ°å½“å‰ç”¨æˆ·"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  provider: 
                    type: "string"
                    enum: ["google", "github", "wechat"]
                  provider_user_id: 
                    type: "string"
                  access_token: 
                    type: "string"
                    description: "OAuth æä¾›å•†çš„ access_token"
                required: 
                  - "provider"
                  - "provider_user_id"
        responses: 
          "200": 
            description: "å…³è”æˆåŠŸ"
          "409": 
            description: "è¯¥ç¤¾äº¤è´¦å·å·²è¢«å…¶ä»–ç”¨æˆ·å…³è”"

    /api/v1/account/link/{provider}: 
      delete: 
        operationId: unlinkAccount
        tags: 
          - "AccountLinking"
        summary: "å–æ¶ˆå…³è” / Unlink Account"
        description: "å–æ¶ˆå…³è”æŒ‡å®šæä¾›å•†çš„ç¤¾äº¤è´¦å·"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "provider"
            in: "path"
            required: true
            schema: 
              type: "string"
              enum: ["google", "github", "wechat"]
        responses: 
          "200": 
            description: "å–æ¶ˆå…³è”æˆåŠŸ"
          "400": 
            description: "æ— æ³•å–æ¶ˆï¼ˆå¯èƒ½æ˜¯å”¯ä¸€çš„ç™»å½•æ–¹å¼ï¼‰"

    /api/v1/account/link/check/{provider}: 
      get: 
        operationId: checkLinkedAccount
        tags: 
          - "AccountLinking"
        summary: "æ£€æŸ¥å¯å…³è”æ€§ / Check Linkability"
        description: "æ£€æŸ¥æŒ‡å®šæä¾›å•†è´¦å·æ˜¯å¦å¯ä»¥å…³è”ï¼ˆæ— å†²çªï¼‰"
        security: 
          - 
            bearerAuth: []
        parameters: 
          - 
            name: "provider"
            in: "path"
            required: true
            schema: 
              type: "string"
              enum: ["google", "github", "wechat"]
        responses: 
          "200": 
            description: "æ£€æŸ¥ç»“æœ"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        can_link: 
                          type: "boolean"
                        reason: 
                          type: "string"

    /api/v1/account/link-oauth: 
      post: 
        operationId: linkOAuthAccount
        tags: 
          - "AccountLinking"
        summary: "å®‰å…¨å…³è” / Secure Link via OAuth Code"
        description: "é€šè¿‡ OAuth æˆæƒç æœåŠ¡ç«¯äº¤æ¢å®‰å…¨åœ°å…³è”ç¤¾äº¤è´¦å·"
        security: 
          - 
            bearerAuth: []
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  provider: 
                    type: "string"
                    enum: ["google", "github", "wechat"]
                  code: 
                    type: "string"
                    description: "OAuth æˆæƒç "
                  redirect_uri: 
                    type: "string"
                    format: "uri"
                required: 
                  - "provider"
                  - "code"
        responses: 
          "200": 
            description: "å…³è”æˆåŠŸ"
          "409": 
            description: "è¯¥ç¤¾äº¤è´¦å·å·²è¢«å…¶ä»–ç”¨æˆ·å…³è”"

    # ============================================
    # Branding / å“ç‰Œé…ç½®
    # ============================================
    /api/v1/branding/{clientId}: 
      get: 
        operationId: getBranding
        tags: 
          - "Branding"
        summary: "è·å–å“ç‰Œé…ç½® / Get Branding"
        description: "è·å–æŒ‡å®šåº”ç”¨çš„å“ç‰Œé…ç½®ä¿¡æ¯ï¼ˆé¢œè‰²ã€Logoã€ç¤¾äº¤ç™»å½•è®¾ç½®ç­‰ï¼‰ã€‚æ— éœ€è®¤è¯ã€‚"
        parameters: 
          - 
            name: "clientId"
            in: "path"
            required: true
            schema: 
              type: "string"
            description: "åº”ç”¨çš„ Client ID"
        responses: 
          "200": 
            description: "å“ç‰Œé…ç½®ä¿¡æ¯"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    success: 
                      type: "boolean"
                    data: 
                      type: "object"
                      properties: 
                        app_name: 
                          type: "string"
                        logo_url: 
                          type: "string"
                          format: "uri"
                        primary_color: 
                          type: "string"
                        social_logins: 
                          type: "array"
                          items: 
                            type: "string"

    # ============================================
    # OIDC Discovery / OpenID Connect å‘ç°
    # ============================================
    /.well-known/openid-configuration: 
      get: 
        operationId: getOidcConfig
        tags: 
          - "OIDC"
        summary: "OIDC å‘ç°æ–‡æ¡£ / Discovery Document"
        description: "OpenID Connect Provider Configuration Information"
        responses: 
          "200": 
            description: "OIDC é…ç½®"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    issuer: 
                      type: "string"
                    authorization_endpoint: 
                      type: "string"
                    token_endpoint: 
                      type: "string"
                    userinfo_endpoint: 
                      type: "string"
                    jwks_uri: 
                      type: "string"
                    response_types_supported: 
                      type: "array"
                      items: 
                        type: "string"
                    grant_types_supported: 
                      type: "array"
                      items: 
                        type: "string"
                      example: ["authorization_code", "client_credentials", "refresh_token"]
                    scopes_supported: 
                      type: "array"
                      items: 
                        type: "string"
                      example: ["openid", "profile", "email", "phone"]
                    id_token_signing_alg_values_supported: 
                      type: "array"
                      items: 
                        type: "string"
                      example: ["RS256"]
                    code_challenge_methods_supported: 
                      type: "array"
                      items: 
                        type: "string"
                      example: ["S256", "plain"]

    /.well-known/jwks.json: 
      get: 
        operationId: getJwks
        tags: 
          - "OIDC"
        summary: "JWKS ç«¯ç‚¹ / JWKS Endpoint"
        description: "JSON Web Key Set â€” ç”¨äºéªŒè¯ ID Token ç­¾åçš„å…¬é’¥é›†åˆ"
        responses: 
          "200": 
            description: "JWKS"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    keys: 
                      type: "array"
                      items: 
                        type: "object"
                        properties: 
                          kty: 
                            type: "string"
                            example: "RSA"
                          use: 
                            type: "string"
                            example: "sig"
                          kid: 
                            type: "string"
                          alg: 
                            type: "string"
                            example: "RS256"
                          n: 
                            type: "string"
                          e: 
                            type: "string"

  components: 
    securitySchemes: 
      bearerAuth: 
        type: "http"
        scheme: "bearer"
        bearerFormat: "JWT"
        description: "JWT Access Token"
    schemas: 
      LoginResponse: 
        type: "object"
        properties: 
          success: 
            type: "boolean"
            example: true
          data: 
            type: "object"
            properties: 
              user: 
                $ref: "#/components/schemas/User"
              access_token: 
                type: "string"
              refresh_token: 
                type: "string"
              expires_in: 
                type: "number"
                example: 3600
              is_new_user: 
                type: "boolean"
      UserResponse: 
        type: "object"
        properties: 
          success: 
            type: "boolean"
          data: 
            $ref: "#/components/schemas/User"
      User: 
        type: "object"
        properties: 
          id: 
            type: "string"
            format: "uuid"
          phone: 
            type: "string"
            nullable: true
          email: 
            type: "string"
            format: "email"
            nullable: true
          nickname: 
            type: "string"
            nullable: true
          avatar_url: 
            type: "string"
            format: "uri"
            nullable: true
      OAuth2TokenResponse: 
        type: "object"
        properties: 
          access_token: 
            type: "string"
          token_type: 
            type: "string"
            example: "Bearer"
          expires_in: 
            type: "number"
            example: 3600
          refresh_token: 
            type: "string"
      Error: 
        type: "object"
        properties: 
          success: 
            type: "boolean"
            example: false
          error: 
            type: "object"
            properties: 
              code: 
                type: "string"
              message: 
                type: "string"

